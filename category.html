<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分类</title>

    <link rel="SHORTCUT ICON" href="./img/icon.jpg">

    <script src="js/jquery-3.2.1.js"></script>
    <script src="js/marked.js"></script>
    <script src="js/storm.js"></script>

    <link rel="stylesheet" href="css/content.css"/>
    <link href="css/prettify.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <script>

        // 设定标题
        var categoryName = getParaValue("category");
        if (categoryName === null) {
            // Get all posts in all categories
            $("title").html("分类目录");
        } else {
            // Get target category
            $("title").html("分类：" + categoryName);
        }

    </script>

</head>
<body>

<!--
获取在 URL 中以 POST 方式发送的 Category-name 参数。之后就会到 post.xml 中查找所有属于此类的 post，并在此页中显示出来。
-->

<div id="nav">
    <div class="container">
        <div id="icon">
            <a href="./index.html">
                <img id="avatar" src="img/icon.jpg">
            </a>
        </div>
        <div id="list" style="display: block; float: left">
            <ul class="nav-list">
                <li class="nav-list-item"><a href="./index.html">首页</a></li>
                <li class="nav-list-item"><a href="./category.html">分类</a></li>
                <li class="nav-list-item"><a href="./post.html?name=about">关于我</a></li>
            </ul>
        </div>
    </div>
</div>

<div id="blog-info">

    <h1>stormlin</h1>
    <h2>On the way to be perfect</h2>

</div>

<div id="main">

    <div id="post-list">

        <script>

            /*
             * 从 get 请求参数中获取 categoryName，如果此项为空，则返回所有分类的所有文章；
             * 如果 categoryName 不为空，则从 categoryName 指定的分类获取文章
             *
             * 每一个分类下的所有文章组成一个 post-list-unit，然后 append 到这个 div 中。
             */
            if (categoryName === null) {
                /* Get all post with their own category */
                // 从 categories.xml 中获取所有 category
                var categories = getCategories();
                for (var i = 0; i < categories.length; i++) {
                    // Post list
                    var posts = getPostListWithCategory(categories[i].name);
                    printCategoryUnit(posts, getCategoryTextByName(categories[i].name));
                }
            } else {
                /* Get specific category with name */
                $("#main").append("<h1 class='categoryTitle'>/* Class = " + getCategoryTextByName(categoryName) + " */</h1>");
                printPostList(getPostListWithCategory(categoryName));
            }

        </script>

    </div>

</div>

<script>
    getFooter();
</script>

</body>
</html>